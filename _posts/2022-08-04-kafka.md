---
layout: post
title:  "kafka 기초 "
date:   2022-08-04 16:20:21 +0900
categories: kafka
---

# 카프카 기초

## Kafka feature

|kafka producer| kafka| kafka consumer|
|Source App| topic1, topic2 .. | TargetApplication|

## Kafka topic
- 여러개의 토픽이 있을 수 있고
- 토픽별로 여러개의 파티션이 있다.
- consumer가 데이터를 가져가지만, 데이터는 삭제되지 않는다.
- 파티션의 삭제가 되는 시점은 최대 record 보존시간

## broker
- 카프카가 설치되어있는 서버단위
    - 보통 3개 이상 구성

## replication
- 파티션 복제를 뜻함
- replication 1 -> partition 1
- replication 2 -> 원본 1개 복제본 1개

## 파티셔너
- 프로듀서가 데이터보내면, 무조건 파티셔너를 통해 브로커로 데이터가 전송됨
- 어떤 파티션에 전송할지 설정
- message-key
    - 파티셔너에 의해 해시값이 결정됨

## lag
- 프로듀셔가 데이터를 넣는것이 컨슈머에서 데이터를 가져가는것보다 속도가 빠르다면 오프셋간의 차이가 발생
- 주로 컨슈머 상태에대해 볼때 확인
- 프로듀서가 넣은 데이터의 오프셋과 컨슈머가 가져가는 데이터의 오프셋 차이를 기반으로 함
- 렉은 여러개 존재할 수 있다(-> 파티션이 여러개 있기 때문에)

## 버로우
- 멀티 카프카 클러스터 lag을 모니터링 가능
- 슬라이딩 윈도으를 통해 컨슈머 스테이터스를 확인가능

## rabbitMQ, resdis Queue, kafka 차이점
- 메시지 브로커는 앞의 둘
- 이벤트 브로커는 카프카
