---
layout: post
title:  "아파치 카프카 스터디 - 1"
date:   2023-01-08 18:20:21 +0900
categories: kafka, spring
---

> 아프치 카프카 애플리케이션 프로그래밍 스터디 - 1 


# 목표?
- 회사에서 대용량 데이터를 처리하는것에 있어, 카프카를 사용하고 있으므로, 제대로된 학습을 통해 원하는 처리를 할 수 있도록 한다.


## 카프카란?
- 링크드인에서 개발
- 시간이 지날수록 애플리케이션의 개수가 증가함으로써 데이터 관리가 복잡해짐 => 장애가 발생우려
- 내부 데이터 흐름을 개선하기 위해 개발
- `각각의 애플리케이션끼리 연결하여 데이터를 처리하는 것이 아니라 한 곳에 모아 처리할 수 있도록 중앙집중화`
- 카프카 내부에 저장되는 파티션 동작은 FIFO 방식의 큐 자료구조와 유사.
- 큐에서 데이터를 보내는 것이 `프로듀서`, 큐에서 데이터를 가져가는 것이 `컨슈머`
- 데이터 포맷은 제한이 없다. 직렬화, 역직렬화를 통해 ByteArray로 통신 => 자바를 지원

## 데이터레이크
- 빅 데이터를 관리하고 사용하는 측면에서 중요한 용어.
- 데이터가 모이는 저장공간
- 운영되는 서비스로부터 수집 가능한 모든 데이터를 모으는 것


## 카프카 특징
- 높은 처리량
    - 프로듀서가 브로커로 데이터를 보낼 때와 컨슈머로 데이터를 받을때 모두 묶어서 전송
    - 많은 양의 데이터를 송수신할 때 맺어지는 네트워크 비용을 절약할 수 있다.
    - 많은 양의 데이터를 묶음 단위로 처리하는 배치로 빠르게 처리할 수 있고, 실시간 로그성 데이터를 처리하는데에 적합
    - 파티션 단위를 통해 동일 목적의 데이터를 여러 파티션에 분배하고, 데이터를 병렬 처리할 수 있다.
    - 파티션 개수만큼 컨슈머 개수를 늘려 동일한 시간당 데이터 처리량을 늘리는 것
- 확장성
    - 데이터 파이프라인에서 얼마나 데이터를 들어오는지 예측하기 어렵다.
    - 가변적인 환경에서 안정적으로 확장가능하도록 설계되어있다.
    - 데이터가 적을 때 카프카 클러스터의 브로커를 최소한의 개수로 운영하다가 데이터가 많아지면 클러스터의 브로커 개수를 자연스럽게 늘려 스케일 아웃 할 수 있고, 반도래 스케일 인 할 수 있다.
- 영속성
    - 의도치 않게 프로그램이 종료되더라도, 사라지지 않는 것
    - 카프카는 전송받은 데이터를 파일 시스템에 적재한다.
    - 페이지 캐시 메모리 영역을 사용하여, 한번 읽은 내용은 메모리에 저장하였다가 다시 사용할 수 있다.
- 고가용성
    - 3개이상의 카프카 서버로 운영되는 카프카 클러스터는 일부 서버에 장애가 발생하더라도 무중단으로 안전하고 지속적으로 데이터를 처리할 수 있다.
    - 클러스터로 이루어진 카프카는 데이터의 복제를 통해 고가용성 특징을 가지게 되었다.
    - 프로듀서로 전송된 데이터를 1대의 브로커에만 저장하는것이 아니라 또 다른 브로커에도 저장한다.
- `카프카 클러스터를 3대 이상해야하는 이유`
    - 브로커 3대 중 1개의 브로커가 장애가 나더라도 지속적으로 데이터를 처리할 수 있기 때문이다.
        - min.insync.replicas 옵션보다 작은 수의 브로커가 존재할 때는 토픽에 더는 데이터를 넣을 수가 없다.



