---
layout: post
title:  "아파치 카프카 스터디 - 2"
date:   2023-01-09 12:20:21 +0900
categories: kafka, spring
---

> 아프치 카프카 애플리케이션 프로그래밍 스터디 - 2


# 목표?
- 회사에서 대용량 데이터를 처리하는것에 있어, 카프카를 사용하고 있으므로, 제대로된 학습을 통해 원하는 처리를 할 수 있도록 한다.


# 카프카 기본개념 

## 카프카 브로커, 클러스터, 주키퍼
- 브로커: 카프카 클라이언트와 데이터를 주고받기 위해 사용하는 주체이자, 데이터를 분산 저장하여 장애가 발생하더라도 안전하게 사용할 수 있도록 도와주는 어플리케이션
    1. 하나의 서버에는 한 개의 카프카 브로커 프로세서가 실행
    2. 안전하게 보관되고 처리하기 위해서 3대 이상의 브로커 서버를 1개의 클러스터로 묶어 운영
    3. 카프카 클러스터로 묶인 브로커들은 프로듀서가 보낸 데이터들을 안전하게 분산저장 및 데이터 복제 역할을 수행
    - 프로듀서로부터 데이터를 전달받으면 카프카 브로커는 프로듀서가 요청한 토픽의 파티션에 데이터를 저장하고 컨슈머가 데이터를 요청하면 파티션에 저장된 데이터를 전달한다. 그러면 전달된 데이터는 `파일시스템에 저장된다`(/tmp/kafka-logs)
        - config/server.properties의 log.dir 옵션에 정의한 디렉토리에 데이터를 저장, 토픽 이름과 파티션 번호의 조합으로 하위 디렉토리를 생성하여 데이터 저장
        - log에는 메시지와 메타데이터를 저장. index는 메시지의 오프셋을 인덱싱한 정보를 담은 파일이다.
        - timeindex 파일에는 메시지에 포함된 타임스탬프 값을 기준으로 인덱싱한 정보가 담겨있다. -> 타임스탬프는 브로커가 적재한 데이터를 삭제하거나 압축하는데 사용한다.
